# å…«å­—æ¨¡å—å®ç°æ€»ç»“

## ğŸ“‹ æ¦‚è¿°

å…«å­—æ¨¡å—æä¾›å®Œæ•´çš„å››æŸ±å…«å­—æ’ç›˜åŠŸèƒ½ï¼Œæ”¯æŒå¤§è¿ã€æµå¹´ã€æµæœˆã€æµæ—¥ã€æµæ—¶è®¡ç®—ã€‚

## âœ… æ ¸å¿ƒåŠŸèƒ½

### 1. å››æŸ±å…«å­—
- ä»å…¬å†åˆ›å»ºï¼š`BaZi::from_solar(year, month, day, hour, minute)`
- ä»å†œå†åˆ›å»ºï¼š`BaZi::from_lunar(year, month, day, hour, minute)`
- åŒ…å«ï¼šå¹´æŸ±ã€æœˆæŸ±ã€æ—¥æŸ±ã€æ—¶æŸ±ã€æ—¬ç©º

### 2. åç¥ç³»ç»Ÿ
- **æ¥æº**ï¼šä½¿ç”¨ `ganzhi.cppm` å…¬å…±æ¨¡å—å®šä¹‰
- **å‡½æ•°**ï¼š`get_shi_shen(day_gan, target_gan)`
- **ç±»å‹**ï¼šæ¯”è‚©ã€åŠ«è´¢ã€é£Ÿç¥ã€ä¼¤å®˜ã€åè´¢ã€æ­£è´¢ã€ä¸ƒæ€ã€æ­£å®˜ã€åå°ã€æ­£å°
- **åº”ç”¨**ï¼šå››æŸ±ã€å¤§è¿ã€æµå¹´ã€æµæœˆã€æµæ—¥ã€æµæ—¶éƒ½è®¡ç®—åç¥

### 3. å¤§è¿ç³»ç»Ÿ
- **èµ·è¿å¹´é¾„**ï¼šä½¿ç”¨ `tyme::ChildLimit` ç²¾ç¡®è®¡ç®—
- **é¡ºé€†è§„åˆ™**ï¼šé˜³ç”·é˜´å¥³é¡ºæ’ï¼Œé˜´ç”·é˜³å¥³é€†æ’
- **å¤§è¿è·¨åº¦**ï¼šæ¯ä¸ªå¤§è¿10å¹´
- **ä¿¡æ¯åŒ…å«**ï¼šå¹²æ”¯ã€åç¥ã€èµ·æ­¢å¹´é¾„

### 4. æµå¹´æµæœˆæµæ—¥æµæ—¶
- **æµå¹´**ï¼šæ¯å¹´çš„å¹²æ”¯å’Œåç¥
- **æµæœˆ**ï¼šæ¯æœˆçš„å¹²æ”¯å’Œåç¥
- **æµæ—¥**ï¼šæ¯æ—¥çš„å¹²æ”¯å’Œåç¥
- **æµæ—¶**ï¼šæ¯æ—¶çš„å¹²æ”¯å’Œåç¥

### 5. ç«¥é™è¯¦ç»†ä¿¡æ¯ â­æ–°å¢
- **èµ·è¿å¹´é¾„**ï¼šç²¾ç¡®åˆ°å¹´æœˆæ—¥æ—¶åˆ†
- **å‡ºç”Ÿæ—¶åˆ»**ï¼šå®Œæ•´çš„å…¬å†æ—¶é—´
- **èµ·è¿æ—¶åˆ»**ï¼šå¼€å§‹èµ·è¿çš„å…¬å†æ—¶é—´
- **ç«¥é™ä¿¡æ¯**ï¼šå¹´æ•°ã€æœˆæ•°ã€æ—¥æ•°ã€æ—¶æ•°ã€åˆ†é’Ÿæ•°

### 6. tyme åº“å®Œæ•´è®¿é—® â­æ–°å¢
- **å¤§è¿å¯¹è±¡**ï¼š`tyme::DecadeFortune` å®Œæ•´åŠŸèƒ½
- **å°è¿å¯¹è±¡**ï¼š`tyme::Fortune` å®Œæ•´åŠŸèƒ½
- **å¹²æ”¯å¹´**ï¼šèµ·æ­¢å¹´ä»½çš„å¹²æ”¯è¡¨ç¤º
- **å…­åç”²å­**ï¼šå®Œæ•´çš„å¹²æ”¯ä¿¡æ¯
- **ä¸‹ä¸€å¤§è¿**ï¼šæ”¯æŒé“¾å¼è®¿é—®

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ¨¡å—ä¾èµ–

```
ZhouYi.BaZi (å…«å­—æ¨¡å—)
  â”œâ”€â”€ ZhouYi.BaZiBase (å…«å­—åŸºç¡€ - Pillar, BaZi)
  â”œâ”€â”€ ZhouYi.GanZhi (å¹²æ”¯ç³»ç»Ÿ - åŒ…å«åç¥)
  â”œâ”€â”€ ZhouYi.WuXingUtils (äº”è¡Œå·¥å…·)
  â”œâ”€â”€ ZhouYi.tyme (æ—¶é—´åº“ - ç«¥é™ã€å¤§è¿)
  â”œâ”€â”€ nlohmann.json (JSONæ”¯æŒ)
  â””â”€â”€ fmt (æ ¼å¼åŒ–è¾“å‡º)
```

### æ ¸å¿ƒç±»

```
DaYun (å¤§è¿ä¿¡æ¯)
  â”œâ”€â”€ pillar: Pillar
  â”œâ”€â”€ start_age: int
  â”œâ”€â”€ end_age: int
  â”œâ”€â”€ gan_shi_shen: ShiShen
  â””â”€â”€ zhi_shi_shen: ShiShen

DaYunSystem (å¤§è¿ç³»ç»Ÿ)
  â”œâ”€â”€ da_yun_list: vector<DaYun>
  â”œâ”€â”€ qi_yun_age: int
  â”œâ”€â”€ shun_pai: bool
  â””â”€â”€ child_limit: tyme::ChildLimit

LiuNian (æµå¹´)
  â”œâ”€â”€ year: int
  â”œâ”€â”€ pillar: Pillar
  â”œâ”€â”€ age: int
  â”œâ”€â”€ gan_shi_shen: ShiShen
  â””â”€â”€ zhi_shi_shen: ShiShen

BaZiResult (å®Œæ•´ç»“æœ)
  â”œâ”€â”€ ba_zi: BaZi
  â”œâ”€â”€ is_male: bool
  â”œâ”€â”€ birth info: year, month, day, hour, minute, second
  â””â”€â”€ da_yun_system: DaYunSystem
```

## ğŸ”§ æŠ€æœ¯ç‰¹ç‚¹

### 1. ä½¿ç”¨ tyme åº“ç²¾ç¡®è®¡ç®—
- **ç«¥é™ç³»ç»Ÿ**ï¼š`tyme::ChildLimit` ç²¾ç¡®è®¡ç®—èµ·è¿å¹´é¾„
- **èŠ‚æ°”è®¡ç®—**ï¼šæ ¹æ®å‡ºç”Ÿæ—¶é—´å’ŒèŠ‚æ°”è·ç¦»
- **å¤šæµæ´¾æ”¯æŒ**ï¼šé»˜è®¤ã€å…ƒäº¨åˆ©è´ã€Lunaræµæ´¾1ã€Lunaræµæ´¾2

### 2. æ¨¡å—åŒ–è®¾è®¡
- **å…¬å…±å®šä¹‰**ï¼šåç¥å®šä¹‰åœ¨ `ganzhi.cppm`ï¼Œé¿å…é‡å¤
- **åŠŸèƒ½åˆ†ç¦»**ï¼šæ ¸å¿ƒé€»è¾‘ï¼ˆba_zi.cppmï¼‰å’Œæ¥å£ï¼ˆba_zi_controller.cppmï¼‰åˆ†ç¦»
- **æ¸…æ™°ä¾èµ–**ï¼šæ‰€æœ‰ä¾èµ–æ˜ç¡®å£°æ˜

### 3. ç±»å‹å®‰å…¨
- ä½¿ç”¨æšä¸¾ç±»å‹ï¼š`TianGan`, `DiZhi`, `ShiShen`
- ç¼–è¯‘æœŸç±»å‹æ£€æŸ¥
- é¿å…å­—ç¬¦ä¸²é”™è¯¯

### 4. ç°ä»£ C++23
- ä½¿ç”¨ Modules ç³»ç»Ÿ
- `std::expected` é”™è¯¯å¤„ç†ï¼ˆå¾…å®ç°ï¼‰
- `std::ranges` ç®—æ³•
- `std::println` è¾“å‡º

## ğŸ“Š ä½¿ç”¨æµç¨‹

```
1. åˆ›å»ºå…«å­—
   â†“
2. æ’ç›˜ï¼ˆåˆ›å»º BaZiResultï¼‰
   â”œâ”€â”€ è®¡ç®—ç«¥é™ï¼ˆtyme::ChildLimitï¼‰
   â”œâ”€â”€ è®¡ç®—èµ·è¿å¹´é¾„
   â”œâ”€â”€ ç”Ÿæˆå¤§è¿åˆ—è¡¨
   â””â”€â”€ è®¡ç®—åç¥
   â†“
3. æŸ¥è¯¢ä¿¡æ¯
   â”œâ”€â”€ å››æŸ±åç¥
   â”œâ”€â”€ å¤§è¿åˆ—è¡¨
   â”œâ”€â”€ æµå¹´ä¿¡æ¯
   â”œâ”€â”€ æµæœˆä¿¡æ¯
   â””â”€â”€ æµæ—¥æµæ—¶
   â†“
4. å¯¼å‡ºç»“æœ
   â”œâ”€â”€ æ§åˆ¶å°æ˜¾ç¤º
   â”œâ”€â”€ JSON å¯¼å‡º
   â””â”€â”€ æ‰¹é‡å¤„ç†
```

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬æ’ç›˜

```cpp
import ZhouYi.BaZiController;

// æ’ç›˜ï¼š1990å¹´1æœˆ1æ—¥12æ—¶30åˆ†ï¼Œç”·æ€§
auto result = pai_pan_solar(1990, 1, 1, 12, 30, true);

// æ˜¾ç¤ºç»“æœ
display_result(result);
```

### è·å–å¤§è¿

```cpp
// è·å–èµ·è¿å¹´é¾„
int qi_yun_age = result.da_yun_system.get_qi_yun_age();

// è·å–æ‰€æœ‰å¤§è¿
for (const auto& da_yun : result.da_yun_system.get_da_yun_list()) {
    std::println("å¤§è¿: {} ({}-{}å²)", 
                 da_yun.pillar.to_string(),
                 da_yun.start_age, da_yun.end_age);
}

// æŸ¥è¯¢35å²çš„å¤§è¿
auto current_da_yun = result.get_current_da_yun(35);
```

### è·å–æµå¹´æµæœˆ

```cpp
// 2024å¹´æµå¹´
auto liu_nian = result.get_liu_nian(2024);
std::println("æµå¹´: {} {}å²", liu_nian.pillar.to_string(), liu_nian.age);

// 2024å¹´6æœˆæµæœˆ
auto liu_yue = result.get_liu_yue(2024, 6);
std::println("æµæœˆ: {}", liu_yue.pillar.to_string());
```

### è®¿é—®ç«¥é™å’Œ tyme åº“

```cpp
// ç«¥é™è¯¦ç»†ä¿¡æ¯
auto detail = result.get_child_limit_detail();
std::println("èµ·è¿: {}å² ({}å¹´{}æœˆ{}å¤©)", 
             detail.start_age,
             detail.year_count,
             detail.month_count,
             detail.day_count);

// è·å– tyme å¤§è¿å¯¹è±¡
auto decade = result.get_tyme_decade_fortune(0);
std::println("å¤§è¿: {} ({}-{}å²)", 
             decade.get_name(),
             decade.get_start_age(),
             decade.get_end_age());

// è·å–å°è¿
auto fortune = result.get_tyme_fortune(0);
std::println("å°è¿: {}", fortune.get_name());
```

## ğŸ“ˆ æ€§èƒ½ç‰¹ç‚¹

- âœ… ç¼–è¯‘æœŸè®¡ç®—ï¼ˆconstexprï¼‰
- âœ… é›¶æ‹·è´è®¾è®¡ï¼ˆä½¿ç”¨å¼•ç”¨å’Œç§»åŠ¨è¯­ä¹‰ï¼‰
- âœ… é«˜æ•ˆæŸ¥æ‰¾ï¼ˆä½¿ç”¨ map å’Œ unordered_mapï¼‰
- âœ… æ‰¹é‡å¤„ç†æ”¯æŒ

## ğŸ”® æœªæ¥è§„åˆ’

1. **ç¥ç…ç³»ç»Ÿ**
   - ç¦„ç¥ã€ç¾Šåˆƒã€æ¡ƒèŠ±ã€é©¿é©¬
   - å¤©ä¹™è´µäººã€åç›–ã€å°†æ˜Ÿ
   - ç©ºäº¡ã€åŠ«ç…ã€ç¾ç…

2. **æ ¼å±€åˆ¤æ–­**
   - æ­£å®˜æ ¼ã€åè´¢æ ¼ç­‰å…«æ ¼
   - å¤–æ ¼ï¼ˆä»æ ¼ã€åŒ–æ ¼ï¼‰
   - æ ¼å±€é«˜ä½åˆ†æ

3. **ç”¨ç¥åˆ†æ**
   - è‡ªåŠ¨ç¡®å®šç”¨ç¥
   - å–œå¿Œç¥åˆ¤æ–­
   - è°ƒå€™ç”¨ç¥

4. **å‰å‡¶åˆ¤æ–­**
   - å¤§è¿æµå¹´å‰å‡¶
   - æµæœˆæµæ—¥åˆ¤æ–­
   - è¿åŠ¿é¢„æµ‹

## ğŸ“š å‚è€ƒèµ„æ–™

- `tyme4cpp` åº“æ–‡æ¡£ï¼šhttps://github.com/6tail/tyme4cpp
- å…«å­—å‘½ç†å­¦ç»å…¸è‘—ä½œ
- ä¼ ç»Ÿèµ·è¿ç®—æ³•

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç å’Œå»ºè®®ï¼

---

**æœ€åæ›´æ–°**ï¼š2024-10-14
**ç‰ˆæœ¬**ï¼šv1.0.0
**ä½œè€…**ï¼šZhouYiLab Team

